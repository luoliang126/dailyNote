/**
 * Created by ly on 2017/5/19.
 */
app.controller("TCPcontroller",function($scope){

    $scope.testWebSocket = function(){
        var sendMsg = $("#inputMessage").val();
        var ws = new WebSocket("ws://localhost:8080");
        ws.onopen = function (e) {
            if(sendMsg && sendMsg != ""){
                ws.send(sendMsg); //注意：回调函数，必须要等到建立起链接后才能发送数据
            }else{
                alert("提交有效数据")
            }
            ws.onmessage = function (evt) {
                var receiveMessage = evt.data;
                $("#showMessage").append($("<p> " + receiveMessage + " </p>"));
                ws.close(); //每次发送接收完数据后就关闭
            };
        }
        ws.onclose = function() {  //监听关闭链接的回调函数
            console.log("连接已关闭...");
        };
    }

    //websocket.io实例
    //打开对话框
    $scope.openSocket = function() {
        var layerDiolog = new Layer({
            layerType: "alert", //类型有tips，alert
            width: "860",   //弹窗宽，高
            height: "560",
            title: "对话框",  //弹窗标题
            url: "tipsContent/tipsContentText/TCP/dialog.html" //通过iframe加载时的url
        });
    }


})
